[{"text":"Hello, suppose we want to actually print out some integer values","width":312.18181824684143},{"text":"write() doesn't give us that fuctionality","width":119.18181824684143},{"text":"write() is the low level call that we make to the operating system","width":250.18181824684143},{"text":"to say \"look, here's a pointer to some memory and please take so many bytes from that memory and send it out to a file\"","width":527.1818182468414},{"text":"or, possibly, another device","width":112.18181824684143},{"text":"if we want to change a bit pattern into a sequence of characters because we want to read, say, one-seven for the value seventeen","width":533.1818182468414},{"text":"that's not something that the system does","width":118.18181824684143},{"text":"instead, we've got some C standard library calls that we can call","width":256.18181824684143},{"text":"that do this for us","width":144.18181824684143},{"text":"and they will wrap the call to write()","width":186.18181824684143},{"text":"as an example, let's try printing something out","width":328.18181824684143},{"text":"we can say \"printf my value is\"","width":443.18181824684143},{"text":"and I can say \"%d\"","width":133.18181824684143},{"text":"this means that the next argument I give in printf() better be an integer value","width":444.18181824684143},{"text":"so the bit pattern we pass to printf() will be treated as an integer","width":294.18181824684143},{"text":"to be displayed","width":73.18181824684143},{"text":"so let's have a variable called result","width":220.18181824684143},{"text":"and I can say result is sixty five","width":187.18181824684143},{"text":"if I attempt to run this, we're using printf(), we haven't declared it beforehand so we get a warning","width":567.1818182468414},{"text":"\"oh, you're just using it.\" and, what we should've done is actually declare the function signature of printf()","width":639.1818182468414},{"text":"and that I know from looking at the man pages","width":253.18181824684143},{"text":"is inside standard IO dot h","width":221.18181824684143},{"text":"if you're coming from a cpp background, there's no IO streams","width":234.18181824684143},{"text":"we dont have operator overloading. instead, let's use printf()","width":210.18181824684143},{"text":"so we've got \"my value is 65\"","width":153.18181824684143},{"text":"and, you'll see that actually this was printed out after the \"hello hello hello hello","width":572.1818182468414},{"text":"here's why: printf() has a buffer. the C libraries have a buffer","width":275.18181824684143},{"text":"so it's only going to call write() when that buffer is full","width":198.18181824684143},{"text":"or if we explicitly tell it to","width":103.18181824684143},{"text":"or if we finish a line","width":173.18181824684143},{"text":"so let's put a newline in here and run it again","width":280.18181824684143},{"text":"this time, we've compiled it, and we should see that \"my value is 65\" appear before my hellos","width":466.18181824684143},{"text":"so this time, because we sent a new line, printf() will be making that call to write()","width":443.18181824684143},{"text":"to send its buffer out to standard out","width":266.18181824684143},{"text":"so now we can actually print out the value of our file descriptor","width":451.18181824684143},{"text":"let's do that. after we've opened our file, I'll send \"fildes is\" and, we will print out fildes.","width":1412.1818182468414},{"text":"and, let's get rid of the first one","width":156.18181824684143},{"text":"and let's flush our buffer by sending in a newline","width":231.18181824684143},{"text":"and we'll see that our value is three","width":492.18181824684143},{"text":"so, we've opened up a file descriptor who's value is three","width":263.18181824684143},{"text":"in fact, that expected by specification because if we succesfully open a file, we'll get back the lowest unused integer (the lowest unused file descriptor)","width":713.1818182468414},{"text":"as one and two are already being used, we get back three","width":219.18181824684143},{"text":"so just for fun, let's actually close one of the existing file descriptors before we do the open()","width":567.1818182468414},{"text":"so let's close standard error","width":235.18181824684143},{"text":"I'm sorry, we'll close standard out","width":170.18181824684143},{"text":"and, we won't close our own file descriptor until the very end of the program here","width":660.1818182468414},{"text":"so I'm going to move that line down to here","width":163.18181824684143},{"text":"great, so, let's run this","width":378.18181824684143},{"text":"so, what did we do? we opened a file descriptor and now if we look at the output of the program, you'll see we're only getting our dots printed out on standard error","width":840.1818182468414},{"text":"why is that?","width":63.18181824684143},{"text":"what happened to our standard output?","width":63.18181824684143},{"text":"well, we better check out file output dot text","width":163.18181824684143},{"text":"and we'll see that everything printed to standard out has been sent to our file","width":435.18181824684143},{"text":"why? because when we called open(), it gave us back a file descriptor for stream number one. and, that is the. that is where all the standard output is going to go","width":895.1818182468414},{"text":"so, all future output is being sent to our file","width":249.18181824684143},{"text":"this is a neat way if you'd like to do logging","width":252.18181824684143},{"text":"and we've just changed our program so that all future output goes to output dot text","width":405.18181824684143},{"text":"now what if we've got a problem with open() ?","width":253.18181824684143},{"text":"right now, our code doesn't check for any error","width":220.18181824684143},{"text":"and, a better program would actually check the return values of our different calls","width":369.18181824684143},{"text":"for example, it could be that open() could fail. suppose, for example, we gave it a bad file descriptor","width":540.1818182468414},{"text":"so we can see what's going on, I'm not going to close standard out anymore.","width":364.18181824684143},{"text":"I'm just going to give it a bad file name","width":234.18181824684143},{"text":"now, our program compiles correctly of course","width":253.18181824684143},{"text":"but this time our file descriptor is negative one","width":211.18181824684143},{"text":"so, we should check that","width":238.18181824684143},{"text":"in fact, if we check the man page of open(), it's always a good idea to check the section \"return value\"","width":514.1818182468414},{"text":"and you'll see, it's specified here that we'll get back a negative one if an error occurred","width":317.18181824684143},{"text":"so the last thing we'll do today is let's capture that and quit if we get a bad error","width":340.18181824684143},{"text":"so, if fildes equals negative one","width":227.18181824684143},{"text":"a common error is to write equals instead of double equals for comparison","width":273.18181824684143},{"text":"so, we want to quit here","width":238.18181824684143},{"text":"so we'll leave our program, let's exit with a value one","width":166.18181824684143},{"text":"so we'll leave our program, let's exit with a value one","width":206.18181824684143},{"text":"to say: \"hey, we couldn't carry on\"","width":133.18181824684143},{"text":"I could've returned zero but I wanted to show you an alternative way to quit a C program is to call exit","width":327.18181824684143},{"text":"and we'll print out an error","width":312.18181824684143},{"text":"so, something bad happened while calling open","width":285.18181824684143},{"text":"so, we'll use perror()","width":269.18181824684143},{"text":"let's run this","width":170.18181824684143},{"text":"and, I get some implicit problem here that we're calling exit(). I need to find the write #include to call for that.","width":803.1818182468414},{"text":"but, you'll see on the lefthand side that we've got open() failed, so that's the part of the error message that I supplied","width":538.1818182468414},{"text":"followed by a colon followed by no such file or directories","width":213.18181824684143},{"text":"so it's complaining that my file name is bad","width":225.18181824684143},{"text":"if I had included a dot here, this is also an invalid file name because a single dot corresponds to the current directory","width":547.1818182468414},{"text":"and, it's complaining that it can't open that because dot corresponds to a directory","width":413.18181824684143},{"text":"so now it's your turn to play. bye!","width":342.18181824684143}]