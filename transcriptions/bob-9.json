 [{"start":"0:00","end":"0:04","text":"hi so this video is about the environment"},{"start":"0:04","end":"0:08","text":"so in addition to being able to set arguments to our little programs"},{"start":"0:08","end":"0:12","text":"each program also has access to environment variables"},{"start":"0:12","end":"0:14","text":"let's have a look at those now"},{"start":"0:14","end":"0:16","text":"so in my shell over here"},{"start":"0:16","end":"0:18","text":"so my terminal window"},{"start":"0:18","end":"0:20","text":"if i type for example set"},{"start":"0:20","end":"0:22","text":"i can see a list of environment variables"},{"start":"0:22","end":"0:28","text":"so these can be used by the shell and any other programs that we start to help configure their behavior"},{"start":"0:28","end":"0:34","text":"for example we see down here that I am running as superuser"},{"start":"0:34","end":"0:36","text":"as the root on this little system here"},{"start":"0:36","end":"0:40","text":"we can also see that my home directory is in slash root"},{"start":"0:40","end":"0:44","text":"so that's where kind of root's files will be stored"},{"start":"0:44","end":"0:48","text":"great so how will i get access to that in my c programs"},{"start":"0:48","end":"0:50","text":"well there's two ways"},{"start":"0:50","end":"0:54","text":"first of all there's a variable called environ"},{"start":"0:54","end":"1:00","text":"which if we are running in an older posix environment"},{"start":"1:00","end":"1:02","text":"we have to specifically declare "},{"start":"1:02","end":"1:10","text":"in fact we say look there is somewhere in there is already a variable declared called environ and we just need access to it"},{"start":"1:10","end":"1:13","text":"so that's what the extern keyword means"},{"start":"1:13","end":"1:15","text":"we are not trying to say give me additional storage for this"},{"start":"1:15","end":"1:20","text":"rather that the storage for this environment variable has already been made"},{"start":"1:20","end":"1:22","text":"and we just want to be able to reference it inside our program"},{"start":"1:22","end":"1:23","text":"so if i use that"},{"start":"1:23","end":"1:28","text":"you'll see that it's actually a character pointer pointer"},{"start":"1:28","end":"1:32","text":"in other words i'm going to dereference it twice"},{"start":"1:32","end":"1:34","text":"the first time i dereference it"},{"start":"1:34","end":"1:39","text":"i get a pointer and that pointer itself is going to point to character strings"},{"start":"1:39","end":"1:44","text":"and i can keep moving along then to print out different environmental variables"},{"start":"1:44","end":"1:48","text":"so if i had the same kind of pointer "},{"start":"1:48","end":"1:53","text":"call it ptr and i initialize it to environ"},{"start":"1:53","end":"1:56","text":"i could print out the very first one"},{"start":"1:56","end":"2:08","text":"if i say let me print out a string and a new line and if I do star pointer we can follow the money if you like"},{"start":"2:08","end":"2:11","text":"we can follow where that pointer points to"},{"start":"2:11","end":"2:15","text":"so it points to the first entry in this array "},{"start":"2:15","end":"2:19","text":"so we can run this and we see i get the first environment variable"},{"start":"2:19","end":"2:25","text":"which looks like a key or a name followed by an equal sign followed by its value"},{"start":"2:25","end":"2:27","text":"so if i was to add one to the pointer"},{"start":"2:27","end":"2:30","text":"then i move on to the next character pointer"},{"start":"2:30","end":"2:34","text":"and i get the next entry"},{"start":"2:34","end":"2:36","text":"so let's put that in a loop"},{"start":"2:36","end":"2:37","text":"how can i do that"},{"start":"2:37","end":"2:45","text":"well i can say while i might be tempted to say pointer but that's not going to be particularly useful"},{"start":"2:45","end":"2:51","text":"instead i want to say whilst the thing that pointer is looking at is a non null value"},{"start":"2:51","end":"2:54","text":"in other words whilst i have a valid pointer"},{"start":"2:54","end":"3:01","text":"why? because i happen to know that this array has one extra entry at the end which is the null entry"},{"start":"3:01","end":"3:01","text":"which means that its got a pointer that points to nothing"},{"start":"3:01","end":"3:06","text":"so let's also increment our pointer at the end"},{"start":"3:06","end":"3:10","text":"great so we can run this and get a look at all the entries"},{"start":"3:10","end":"3:16","text":"in fact why don't we set a couple of entries here"},{"start":"3:16","end":"3:21","text":"so export secret to be 123456"},{"start":"3:21","end":"3:23","text":"and run our program again"},{"start":"3:23","end":"3:26","text":"this time when we run it"},{"start":"3:26","end":"3:32","text":"the environmental variable secret is part of the environment of our running program"},{"start":"3:32","end":"3:38","text":"if you already know the name of the environment variable that you wish to use"},{"start":"3:38","end":"3:40","text":"you can get to it directly"},{"start":"3:40","end":"3:45","text":"so we can also say hey give me the environment variable and give it a name"},{"start":"3:45","end":"3:53","text":"for example secret and this will give me back a pointer to a character array"},{"start":"3:53","end":"3:57","text":"oops i better call it secret"},{"start":"3:57","end":"4:00","text":"let's print it out and quit"},{"start":"4:00","end":"4:11","text":"so the secret is and we can call exit"},{"start":"4:11","end":"4:18","text":"great i've got a little program that can print out secrets"},{"start":"4:18","end":"4:23","text":"so now i can make my program check that the secret is set for example"},{"start":"4:23","end":"4:31","text":"for example if I try to get an environmental variable that doesn't exist"},{"start":"4:31","end":"4:35","text":"then my pointer is actually going to be nil"},{"start":"4:35","end":"4:37","text":"let me show you that"},{"start":"4:37","end":"4:43","text":"let me try to print out the value of secret as an integer"},{"start":"4:43","end":"4:49","text":"so secret is pointing to nothing"},{"start":"4:49","end":"4:50","text":"we didn't set that environmental variable yet"},{"start":"4:50","end":"5:01","text":"so we for example i could say look if secret is null then i'm not going to let this program run"},{"start":"5:01","end":"5:05","text":"i am just going to stop"},{"start":"5:05","end":"5:19","text":"so we'll stop and let's now change it so that very secret is something like abc"},{"start":"5:19","end":"5:28","text":"and when we run the program again this time you'll see that secret is a valid integer value"},{"start":"5:28","end":"5:38","text":"so that's just an integer representation of the pointer and we got back at that memory location the contents of that environmental variable"},{"start":"5:38","end":"5:40","text":"okay that's enough for me now it's time for you to play"},{"start":"5:40","end":"5:40","text":"bye"}]