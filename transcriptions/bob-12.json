 [{"start":"0:00","end":"0:05","text":"welcome so let's talk about some options other than automatic variables"},{"start":"0:05","end":"0:07","text":"so here's a little problem i've got so far"},{"start":"0:07","end":"0:12","text":"in my main method i want to print out the current time "},{"start":"0:12","end":"0:18","text":"and i'm going to write my function called currenttime that returns a new string array"},{"start":"0:18","end":"0:25","text":"i already know that i cannot make an array in here to hold the result"},{"start":"0:25","end":"0:31","text":"say with two hundred and fifty because when I go to return from this function"},{"start":"0:31","end":"0:36","text":"the array variable won't be pointing to memory that is valid any longer"},{"start":"0:36","end":"0:38","text":"so here is two options"},{"start":"0:38","end":"0:40","text":"i could make my array static"},{"start":"0:40","end":"0:43","text":"so how do i do that"},{"start":"0:43","end":"0:45","text":"just by the keyword static"},{"start":"0:45","end":"0:51","text":"so for example if i were to just say okay i've got myself a static array out here outside of that method"},{"start":"0:51","end":"0:57","text":"then my array lives forever or at least for the length of my process"},{"start":"0:57","end":"1:01","text":"so that gets rid of the problem of having some space"},{"start":"1:01","end":"1:05","text":"i cheated i said look just give me some space for the lifetime of my program here "},{"start":"1:05","end":"1:08","text":"so that's what static does"},{"start":"1:08","end":"1:12","text":"i can also put this inside the function"},{"start":"1:12","end":"1:13","text":"that doesn't change the lifetime of the variable"},{"start":"1:13","end":"1:15","text":"it just changes the scoping"},{"start":"1:15","end":"1:27","text":"so as always that means simply that now the variable name array can only be connected to that piece of memory inside my little method"},{"start":"1:27","end":"1:33","text":"so it's just changing how the actual name of the variable is bound to the memory"},{"start":"1:33","end":"1:36","text":"so that's one method"},{"start":"1:36","end":"1:41","text":"but instead i want to talk about a completely different way which is to use malloc"},{"start":"1:41","end":"1:53","text":"so you're going to come across malloc calloc and realloc"},{"start":"1:53","end":"1:55","text":"today let's talk about malloc "},{"start":"1:55","end":"1:58","text":"which essentially means give me some bytes"},{"start":"1:58","end":"2:00","text":"and i can say how many bytes i need"},{"start":"2:00","end":"2:06","text":"and that storage space is found inside the program's heap"},{"start":"2:06","end":"2:09","text":"so for example if I want one hundred and twenty eight bytes I would say malloc one hundred and twenty eight"},{"start":"2:09","end":"2:14","text":"so this is going to give me a pointer to the very first byte"},{"start":"2:14","end":"2:18","text":"so let's store that inside my little character pointer here"},{"start":"2:18","end":"2:20","text":"and i'll say there is my result"},{"start":"2:20","end":"2:27","text":"it is possible that malloc fails"},{"start":"2:27","end":"2:31","text":"if it is unable to give me one hundred and twenty eight bytes it would give me back an invalid pointer pointed at null or pointed at nothing"},{"start":"2:31","end":"2:44","text":"so i could say look if result is zero or null or if i wanted to be really terse I could say if not result"},{"start":"2:44","end":"2:45","text":"in other words result is null"},{"start":"2:45","end":"2:49","text":"then just return a null pointer"},{"start":"2:49","end":"2:50","text":"i am not going to try and use it"},{"start":"2:50","end":"2:51","text":"it's not a valid pointer"},{"start":"2:51","end":"3:01","text":"otherwise let's put some things inside this and I could turn the current time and store it inside that array"},{"start":"3:01","end":"3:12","text":"so let me use a function called strcpy to put in the current time which is two fifty one pm"},{"start":"3:12","end":"3:22","text":"#include <string.h> let's run this"},{"start":"3:22","end":"3:31","text":"and my program calls currenttime creates some memory and then returns it"},{"start":"3:31","end":"3:32","text":"this is fantastic right"},{"start":"3:32","end":"3:34","text":"i've now got a way to make long lived pieces of memory and put data inside them"},{"start":"3:34","end":"3:40","text":"but with great opportunity comes great responsibility here "},{"start":"3:40","end":"3:51","text":"so what we should do is let our programs is with every malloc we should at some point free up that memory to say hey i've finished with it"},{"start":"3:51","end":"3:55","text":"so the correct way to do this is to keep a pointer around"},{"start":"3:55","end":"3:58","text":"so let's have a pointer down here"},{"start":"3:58","end":"4:00","text":"and when i finished using that memory"},{"start":"4:00","end":"4:02","text":"i can free it"},{"start":"4:02","end":"4:05","text":"to say hey this memory is no longer being used"},{"start":"4:05","end":"4:09","text":"this block of memory of one hundred and twenty eight bytes is no longer being used"},{"start":"4:09","end":"4:17","text":"please put it back into the heap and maybe we will reuse that memory again for a future malloc"},{"start":"4:17","end":"4:23","text":"so good programs will have one free for every malloc "},{"start":"4:23","end":"4:29","text":"in the next video i'll talk about some of the mistakes that we can make with heap allocation"},{"start":"4:29","end":"4:32","text":"but now it's time for you to play with malloc "},{"start":"4:32","end":"4:32","text":"bye"}]